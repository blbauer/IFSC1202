#
# Employee Class (employeeNumber, firstName, lastName, address, city, state, zip)
# Attributes:
#   EmployeeNumber
#   FirstName
#   LastName
#   Address
#   City
#   State
#   Zip
#
class Employee():
    def __init__(self, employeeNumber, firstName, lastName, address, city, state, zip):
        self.EmployeeNumber = employeeNumber
        self.FirstName = firstName
        self.LastName = lastName
        self.Address = address
        self.City = city
        self.State = state
        self.Zip = zip
#
# EmployeeList Class (filename)
# Attributes:
#       EmployeeList - a list of Employee object
#       FileName - File name of a file containing Employee data separated by a comma
#
class EmployeeList():
    def __init__ (self, FileName):
        self.EmployeeList = []
        self.FileName = FileName
#
# ReadEmployee (EmployeeNumber)
#   Looks for index of employee number
#   Returns:
#       EmployeeNumber
#       FirstName
#       LastName
#       Address
#       City
#       State
#       Zip
#
    def ReadEmployee(self, EmployeeNumber):
        EmployeeIndex = self.FindEmployee(int(EmployeeNumber))
        if EmployeeIndex != -1:
            return self.EmployeeList[EmployeeIndex].EmployeeNumber, self.EmployeeList[EmployeeIndex].FirstName, self.EmployeeList[EmployeeIndex].LastName, self.EmployeeList[EmployeeIndex].Address, self.EmployeeList[EmployeeIndex].City, self.EmployeeList[EmployeeIndex].State, self.EmployeeList[EmployeeIndex].Zip
        else:
            return "Employee Not Found"
#
# Add Employee (firstName, lastName, address, city, state, zip)
#   Determines the next Employee Number by calling NextEmployeeNumber
#   Create and append an Employee Object
#
    def AddEmployee(self, firstName, lastName, address, city, state, zip):
        nextEmployeeNumber = self.NextEmployeeNumber()
        self.EmployeeList.append(Employee(nextEmployeeNumber,firstName, lastName, address, city, state, zip))
        return "Employee Added"
#
# Update Employee(employeenumber, firstName, lastName, address, city, state, zip)
#   Looks for index of employee number
#   Updates the object with all of the above values
#    
    def UpdateEmployee(self, employeenumber, firstName, lastName, address, city, state, zip):
        EmployeeIndex = self.FindEmployee(int(employeenumber))
        if EmployeeIndex != -1:
            self.EmployeeList[EmployeeIndex].FirstName = firstName
            self.EmployeeList[EmployeeIndex].LastName = lastName
            self.EmployeeList[EmployeeIndex].Address = address
            self.EmployeeList[EmployeeIndex].City = city
            self.EmployeeList[EmployeeIndex].State = state
            self.EmployeeList[EmployeeIndex].Zip = zip
            return "Employee Updated"
        else:
            return "Employee Not Found"
#
# Delete Employee
#   Looks for index of employee number
#   Deletes the Employee Object from the list
#    
    def DeleteEmployee(self, EmployeeNumber):
        EmployeeIndex = self.FindEmployee(int(EmployeeNumber))
        if EmployeeIndex != -1:
            del self.EmployeeList[EmployeeIndex]
            return "Employee Deleted"
        else:
            return "Employee Not Found"
#
# ReadEmployeeFile
#   Opens FileName file containing employee information
#   Splits each line by comma into a list
#   Creates an Employee Object from the list
#   Appends Employee Object to EmployeeList
#
    def ReadEmployeeFile(self):
        EmployeeFile = open(self.FileName, "r")
        x = EmployeeFile.readline()
        while x != "":
            y = x.split(",")
            self.EmployeeList.append(Employee(y[0].strip(), y[1].strip(), y[2].strip(), y[3].strip(), y[4].strip(), y[5].strip(), y[6].strip()))
            x = EmployeeFile.readline()
        EmployeeFile.close()
#
# WriteEmployeeFile
#   Opens FileName for writing
#   Loops though each Employee in the EmployeeList
#   Writes Employee data in .CSV format
#
    def WriteEmployeeFile(self):
        EmployeeFile = open(self.FileName, "w")
        for i in range(len(self.EmployeeList)):
            EmployeeFile.write(self.EmployeeList[i].EmployeeNumber + ", " + self.EmployeeList[i].FirstName + ", " + self.EmployeeList[i].LastName + ", " + self.EmployeeList[i].Address + ", " + self.EmployeeList[i].City + ", " + self.EmployeeList[i].State + ", " + self.EmployeeList[i].Zip + "\n")
        EmployeeFile.close()
#
# DisplayEmployeeList
#   Prints Employee headings and data from the EmployeeList
#   Loops through the EmployeeList
#   Prints the employee data
#
    def DisplayEmployeeList(self):
        print("{:15s} {:15s} {:15s} {:15s} {:15s} {:15s} {:15s}".format("Employee","First", "Last", "Address", "City", "State", "Zip"))
        print("{:15s} {:15s} {:15s}".format("Number","Name", "Name"))
        print("{:15s} {:15s} {:15s} {:15s} {:15s} {:15s} {:15s}".format(15*"-", 15*"-", 15*"-", 15*"-", 15*"-", 15*"-", 15*"-"))
        for i in range(len(self.EmployeeList)):
            print("{:15s} {:15s} {:15s} {:15s} {:15s} {:15s} {:15s}".format(self.EmployeeList[i].EmployeeNumber, self.EmployeeList[i].FirstName, self.EmployeeList[i].LastName, self.EmployeeList[i].Address, self.EmployeeList[i].City, self.EmployeeList[i].State, self.EmployeeList[i].Zip))
#
# FindEmployee
#   Loops through the EmployeeList looking for a matching Employee Number
#   Return the index of Employee in EmployeeList
#   If Employee not found then return -1
#
    def FindEmployee(self, EmployeeNumberToFind):
        for i in range(len(self.EmployeeList)):
            if int(self.EmployeeList[i].EmployeeNumber) == int(EmployeeNumberToFind):
                return i
        return -1
#
# NextEmployee Number
#   Get the EmployeeNumber of last employee
#   Add 1 to it an make it the Employee Number of the new employee
#
    def NextEmployeeNumber(self):
        lastEmployeeNumber = int(MyEmployeeList.EmployeeList[-1].EmployeeNumber)
        nextEmployeeNumber = str(lastEmployeeNumber + 1)
        return nextEmployeeNumber

    def ValidateEmployeeNumber(self, employeeNumber):
        if employeeNumber.isdigit():
            return ""
        else:
            return "Employee Number is not valid"     

    def ValidateFirstName(self, firstName):
        if firstName != "":
            return ""
        else:
            return "First Name Cannot be Blank"

    def ValidateLastName(self, lastName):
        if lastName != "":
            return ""
        else:
            return "Last Name Cannot be Blank"

    def ValidateAddress(self, address):
        if address != "":
            return ""
        else:
            return "Address Cannot be Blank"
        
    def ValidateCity(self, city):
        if city != "":
            return ""
        else:
            return "City Cannot be Blank"

    def ValidateState(self, state):
        if state != "":
            return ""
        else:
            return "State Cannot be Blank"

    def ValidateZip(self, zip):
        if zip != "":
            return ""
        else:
            return "Zip Code Cannot be Blank"
#
# Main Program
#
#  Create a Employee List Object using a file name
MyEmployeeList = EmployeeList("Final Project Employees.txt")
#
# Read the file and create the list
MyEmployeeList.ReadEmployeeFile()
#
# Display a menu and get selection
Selection = ""
while Selection != "Q":

    print()
    print("(A)dd a New Employee")
    print("(D)elete an Existing Employee")
    print("(C)hange an Existing Employee")
    print("(P)rint All Employees")
    print("(S)ave Changes to File")
    print("(Q)uit")
    print()
    Selection = input("Enter Selection: ").upper()
    print()
#
# Selection A - Add a new Employee
#
    if Selection == "A":
        firstName = input("Enter First Name: ")
        errormessage = MyEmployeeList.ValidateFirstName(firstName)
        while errormessage != "":
            print(errormessage)
            firstName = input("Enter First Name: ")
            errormessage = MyEmployeeList.ValidateFirstName(firstName)

        lastName = input("Enter Last Name: ")
        errormessage = MyEmployeeList.ValidateLastName(lastName)
        while errormessage != "":
            print(errormessage)
            lastName = input("Enter Last Name: ")
            errormessage = MyEmployeeList.ValidateLastName(lastName)

        address = input("Enter Address: ")
        errormessage = MyEmployeeList.ValidateAddress(address)
        while errormessage != "":
            print(errormessage)
            address = input("Enter Address: ")
            errormessage = MyEmployeeList.ValidateFirstName(address)

        city = input("Enter City: ")
        errormessage = MyEmployeeList.ValidateCity(city)
        while errormessage != "":
            print(errormessage)
            city = input("Enter City: ")
            errormessage = MyEmployeeList.ValidateCity(city)

        state = input("Enter State: ")
        errormessage = MyEmployeeList.ValidateState(state)
        while errormessage != "":
            print(errormessage)
            state = input("Enter State: ")
            errormessage = MyEmployeeList.ValidateState(state)

        zip = input("Enter Zip: ")
        errormessage = MyEmployeeList.ValidateZip(zip)
        while errormessage != "":
            print(errormessage)
            state = input("Enter Zip: ")
            errormessage = MyEmployeeList.ValidateZip(zip)

        result = MyEmployeeList.AddEmployee(firstName, lastName, address, city, state, zip)
        print (result)
#
# Selection D - Delete an Existing Employee
#
    elif Selection == "D":
        employeeNumber = input("Enter Employee Number: ")
        result = MyEmployeeList.DeleteEmployee(employeeNumber)
        print(result)
#
# Selection C - Change Data on Existing Employee
#
    elif Selection == "C":
        employeeNumber = int(input("Enter Employee Number: "))
#       Check to see if the Employee exists
        EmployeeIndex = MyEmployeeList.FindEmployee(employeeNumber)
        if EmployeeIndex == -1:
#           Employee does not exist - print error message
            print("Employee Not Found")
        else:
#           Employee exists - prompt for data
            employeeNumber, firstName, lastName, address, city, state, zip = MyEmployeeList.ReadEmployee(employeeNumber)
            print()
            print("(F)irst Name")
            print("(L)Last Name")
            print("(A)ddress")
            print("(C)ity")
            print("(S)tate")
            print("(Z)ip")
            print("(B)ack to Main Menu")
            print()
            Selection = input("Enter Selection: ").upper()
            print()

            if Selection == "F":
                firstName = input("Enter First Name: ")
                errormessage = MyEmployeeList.ValidateFirstName(firstName)
                while errormessage != "":
                    print(errormessage)
                    firstName = input("Enter First Name: ")
                    errormessage = MyEmployeeList.ValidateFirstName(firstName)
                MyEmployeeList.UpdateEmployee(employeeNumber, firstName, lastName, address, city, state, zip)

            elif Selection == "L":
                lastName = input("Enter Last Name: ")
                errormessage = MyEmployeeList.ValidateLastName(lastName)
                while errormessage != "":
                    print(errormessage)
                    lastName = input("Enter Last Name: ")
                    errormessage = MyEmployeeList.ValidateLastName(lastName)
                MyEmployeeList.UpdateEmployee(employeeNumber, firstName, lastName, address, city, state, zip)

            elif Selection == "A":
                address = input("Enter Address: ")
                errormessage = MyEmployeeList.ValidateAddress(address)
                while errormessage != "":
                    print(errormessage)
                    address = input("Enter Address: ")
                    errormessage = MyEmployeeList.ValidateFirstName(address)
                MyEmployeeList.UpdateEmployee(employeeNumber, firstName, lastName, address, city, state, zip)

            elif Selection == "C":
                city = input("Enter City: ")
                errormessage = MyEmployeeList.ValidateCity(city)
                while errormessage != "":
                    print(errormessage)
                    city = input("Enter City: ")
                    errormessage = MyEmployeeList.ValidateCity(city)
                MyEmployeeList.UpdateEmployee(employeeNumber, firstName, lastName, address, city, state, zip)

            elif Selection == "S":
                state = input("Enter State: ")
                errormessage = MyEmployeeList.ValidateState(state)
                while errormessage != "":
                    print(errormessage)
                    state = input("Enter State: ")
                    errormessage = MyEmployeeList.ValidateState(state)
                MyEmployeeList.UpdateEmployee(employeeNumber, firstName, lastName, address, city, state, zip)

            elif Selection == "Z":
                zip = input("Enter Zip: ")
                errormessage = MyEmployeeList.ValidateZip(zip)
                while errormessage != "":
                    print(errormessage)
                    zip = input("Enter Zip: ")
                    errormessage = MyEmployeeList.ValidateZip(zip)
                MyEmployeeList.UpdateEmployee(employeeNumber, firstName, lastName, address, city, state, zip)
            
            elif Selection == "B":
                pass
#
# Invalid Selection
#
            else:
                print("Invalid Selection")        
#
# Selection P - Prints the Employee List
#
    elif Selection == "P":
        MyEmployeeList.DisplayEmployeeList()
#
# Selection S - Save the Employee List to the file
#
    elif Selection == "S":
        MyEmployeeList.WriteEmployeeFile()
        print("Changes Saved")
#
# Selection Q - Quit
#
    elif Selection == "Q":
        pass
#
# Invalid Selection
#
    else:
        print("Invalid Selection")

print("Good-bye")